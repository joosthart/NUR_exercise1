
\section{Cooling rates in cosmological simulations}
In this section the results of exercise 1 will be discussed. In this exercise, cooling tables are used to calculate the cooling rate as a function of redshift, temperature and density. This is done by interpolating the tables.

\subsection*{1a}
In this exercise a plot of the cooling rate is made as a function of temperature for different densities at a redshift of $z=3$ and a metallicity of 25\% solar. The cooling rate is given by 
\begin{equation}
    \Lambda = \Lambda_{\mathrm{H},\mathrm{He}} + \sum_{i>\mathrm{He}} \Lambda_{i,\odot} \frac{n_\mathrm{e}/n_\mathrm{H}}{(n_\mathrm{e}/n_\mathrm{H})_\odot} 10^{[i/\mathrm{H}]},
\end{equation}
where $10^{[i/\mathrm{H}]} \equiv \frac{n_\mathrm{i}/n_\mathrm{H}}{(n_\mathrm{i}/n_\mathrm{H})_\odot}$, using that $n_\mathrm{H} = n_{\mathrm{H},\odot}$. In this case $10^{[i/\mathrm{H}]} = 0.25$, since we assume solar metallicity. Furthermore, we assume that the mass fraction Helium Hydrogen is given by 0.258.

With the above information, $\Lambda$ can be calculated for a given redshift using the cooling tables. Since there is no table for $z=3$, we need to interpolate the cooling rates for $z=2.829$ and $z=3.017$, of which tables are available. Linear interpolation is used.

Figure \ref{fig:coolingrates} shows the cooling rate as a function of temperature for different densities.

\begin{figure}[h!]
  \centering
  \includegraphics[width=0.9\linewidth]{./plots/1a_coolingrates.png}
  \caption{Cooling rates at $z=3$ for different densities are shown as a function of temperature. These cooling rates are calculated from tables for cooling rates at $z=2.829$ and $z=3.017$. Linear interpolation is used to obtain cooling rates for $z=3$.}
  \label{fig:coolingrates}
\end{figure}

\subsection*{1b}
For this exercise, the same interpolator is used to calculate the cooling rates for redshifts ranging from 0 - 9 for a denisty of $n = 0.0001 \mathrm{cm}^{âˆ’3}$ and a metallicity of 50\% solar metallicity. These plots are combined into a movie, simulating the change in cooling rate as a function of redshift and temperature. This movie can be found in the root folder and is called \texttt{coolingrate.mp4}.

\pagebreak

\subsection*{Code}
The code used to generate the results for this exercise is listed below.
\lstinputlisting{problem1.py}

\newpage